all:
  children:
    docker:
      vars:
        builder_type: "docker"
      children:
        ubuntu_docker:
          vars:
            os_type: "ubuntu"
            os_image: "ubuntu:latest"
            provisioners: |
              provisioner "ansible" {
                playbook_file = "ansible/playbook.yml"
              }
            post_processors: |
              post-processor "docker-tag" {
                repository = "myrepo/ubuntu"
                tag        = "latest"
              }
          hosts:
            ubuntu_docker_host:
        centos_docker:
          vars:
            os_type: "centos"
            os_image: "centos:latest"
            provisioners: ""
            post_processors: ""
          hosts:
            centos_docker_host:
    ami:
      vars:
        builder_type: "ami"
      children:
        ubuntu_ami:
          vars:
            os_type: "ubuntu"
            source_ami: "ami-12345678"
            provisioners: |
              provisioner "ansible" {
                playbook_file = "ansible/playbook.yml"
              }
            post_processors: |
              post-processor "manifest" {
                output = "manifest.json"
              }
          hosts:
            ubuntu_ami_host:
        debian_ami:
          vars:
            os_type: "debian"
            source_ami: "ami-87654321"
            provisioners: ""
            post_processors: ""
          hosts:
            debian_ami_host:
        windows_ami:
          vars:
            os_type: "windows"
            source_ami: "ami-windows-id"
            provisioners: |
              provisioner "powershell" {
                inline = ["Install-WindowsFeature -Name Web-Server"]
              }
            post_processors: ""
          hosts:
            windows_ami_host:
